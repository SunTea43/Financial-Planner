<div class="d-flex justify-content-between align-items-center mb-4">
  <h1>Presupuestos</h1>
  <%= link_to "Nuevo Presupuesto", new_budget_path, class: "btn btn-primary" %>
</div>

<% if @budgets.any? %>
  <div class="row">
    <% @budgets.each do |budget| %>
      <div class="col-md-6 mb-4">
        <div class="card h-100">
          <div class="card-header">
            <h5 class="mb-0"><%= budget.name %></h5>
            <small class="text-muted"><span class="badge bg-info"><%= budget.periodicity %></span></small>
          </div>
          <div class="card-body">
            <p class="card-text">
              <strong>Período:</strong> <%= budget.start_date.strftime("%d/%m/%Y") %> - <%= budget.end_date.strftime("%d/%m/%Y") %>
            </p>
            <div class="row mb-3">
              <div class="col-4 text-center">
                <small class="text-muted">Ingresos</small>
                <h6 class="text-success"><%= number_to_currency(budget.total_income) %></h6>
              </div>
              <div class="col-4 text-center">
                <small class="text-muted">Gastos</small>
                <h6 class="text-danger"><%= number_to_currency(budget.total_expenses) %></h6>
              </div>
              <div class="col-4 text-center">
                <small class="text-muted">Flujo Libre</small>
                <h6 class="<%= budget.free_cash_flow >= 0 ? 'text-success' : 'text-danger' %>">
                  <%= number_to_currency(budget.free_cash_flow) %>
                </h6>
              </div>
            </div>
          </div>
          <div class="card-footer">
            <div class="btn-group w-100" role="group">
              <%= link_to "Ver", budget, class: "btn btn-sm btn-primary" %>
              <%= link_to "Editar", edit_budget_path(budget), class: "btn btn-sm btn-secondary" %>
              <%= link_to "Eliminar", budget, data: { turbo_method: :delete, turbo_confirm: "¿Estás seguro?" }, class: "btn btn-sm btn-danger" %>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>
<% else %>
  <div class="alert alert-info">
    <p>No hay presupuestos registrados.</p>
    <%= link_to "Crear primer presupuesto", new_budget_path, class: "btn btn-primary" %>
  </div>
<% end %>

